(()=>{var e={};e.id=7470,e.ids=[7470],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63502:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>b,routeModule:()=>v,serverHooks:()=>c,workAsyncStorage:()=>u,workUnitAsyncStorage:()=>m});var a={};t.r(a),t.d(a,{GET:()=>k,POST:()=>F});var l=t(96559),s=t(48088),o=t(37719),h=t(32190);let n={binance:{name:"Binance",makerFee:2e-4,takerFee:4e-4,vipLevels:[{level:"VIP 0",threshold:0,makerFee:2e-4,takerFee:4e-4,rebateShare:.4},{level:"VIP 1",threshold:1e6,makerFee:19e-5,takerFee:38e-5,rebateShare:.45},{level:"VIP 2",threshold:5e6,makerFee:18e-5,takerFee:36e-5,rebateShare:.5},{level:"VIP 3",threshold:25e6,makerFee:17e-5,takerFee:34e-5,rebateShare:.55},{level:"VIP 4",threshold:1e8,makerFee:16e-5,takerFee:32e-5,rebateShare:.6},{level:"VIP 5",threshold:25e7,makerFee:15e-5,takerFee:3e-4,rebateShare:.65},{level:"VIP 6",threshold:1e9,makerFee:14e-5,takerFee:28e-5,rebateShare:.7},{level:"VIP 7",threshold:25e8,makerFee:13e-5,takerFee:26e-5,rebateShare:.75},{level:"VIP 8",threshold:5e9,makerFee:12e-5,takerFee:24e-5,rebateShare:.8},{level:"VIP 9",threshold:1e10,makerFee:1e-4,takerFee:2e-4,rebateShare:.85}]},bybit:{name:"Bybit",makerFee:1e-4,takerFee:6e-4,vipLevels:[{level:"VIP 0",threshold:0,makerFee:1e-4,takerFee:6e-4,rebateShare:.35},{level:"VIP 1",threshold:1e5,makerFee:9e-5,takerFee:55e-5,rebateShare:.4},{level:"VIP 2",threshold:5e5,makerFee:8e-5,takerFee:5e-4,rebateShare:.45},{level:"VIP 3",threshold:25e5,makerFee:7e-5,takerFee:45e-5,rebateShare:.5},{level:"VIP 4",threshold:1e7,makerFee:6e-5,takerFee:4e-4,rebateShare:.55},{level:"VIP 5",threshold:5e7,makerFee:5e-5,takerFee:35e-5,rebateShare:.6},{level:"VIP 6",threshold:2e8,makerFee:4e-5,takerFee:3e-4,rebateShare:.65},{level:"VIP 7",threshold:5e8,makerFee:3e-5,takerFee:25e-5,rebateShare:.7},{level:"VIP 8",threshold:1e9,makerFee:2e-5,takerFee:2e-4,rebateShare:.75},{level:"VIP 9",threshold:2e9,makerFee:1e-5,takerFee:15e-5,rebateShare:.8}]},okx:{name:"OKX",makerFee:8e-4,takerFee:.001,vipLevels:[{level:"VIP 0",threshold:0,makerFee:8e-4,takerFee:.001,rebateShare:.3},{level:"VIP 1",threshold:1e5,makerFee:75e-5,takerFee:95e-5,rebateShare:.35},{level:"VIP 2",threshold:5e5,makerFee:7e-4,takerFee:9e-4,rebateShare:.4},{level:"VIP 3",threshold:1e6,makerFee:65e-5,takerFee:85e-5,rebateShare:.45},{level:"VIP 4",threshold:5e6,makerFee:6e-4,takerFee:8e-4,rebateShare:.5},{level:"VIP 5",threshold:1e7,makerFee:55e-5,takerFee:75e-5,rebateShare:.55},{level:"VIP 6",threshold:5e7,makerFee:5e-4,takerFee:7e-4,rebateShare:.6},{level:"VIP 7",threshold:1e8,makerFee:45e-5,takerFee:65e-5,rebateShare:.65},{level:"VIP 8",threshold:5e8,makerFee:4e-4,takerFee:6e-4,rebateShare:.7},{level:"VIP 9",threshold:1e9,makerFee:35e-5,takerFee:55e-5,rebateShare:.75}]}};async function k(e){try{let{searchParams:r}=new URL(e.url),t=parseFloat(r.get("volume")||"0"),a=r.get("broker")||"binance",l=r.get("tradeType")||"taker",s=parseInt(r.get("tradesPerMonth")||"20");if(t<=0)return h.NextResponse.json({error:"Trading volume must be greater than 0"},{status:400});if(!n[a])return h.NextResponse.json({error:"Invalid broker specified"},{status:400});let o=n[a],k=o.vipLevels.slice().reverse().find(e=>t>=e.threshold)||o.vipLevels[0],F="maker"===l?k.makerFee:k.takerFee,d=t*F,v=12*d,u=k.rebateShare,m=.1*u,c=d*m,b=v*m,p=t/s,P=p*F,S=c/d*100;return h.NextResponse.json({success:!0,data:{input:{volume:t,broker:a,tradeType:l,tradesPerMonth:s},broker:{name:o.name,vipLevel:k.level,makerFee:k.makerFee,takerFee:k.takerFee,brokerRebateShare:k.rebateShare},fees:{monthly:d,yearly:v,feeRate:F,feePerTrade:P,effectiveFeeRate:F-F*m},rebates:{monthly:c,yearly:b,rebateRate:m,rebatePerTrade:P*m,savingsPercentage:S},savings:{monthly:c,yearly:b,totalYearly:b},metrics:{averageTradeSize:p,tradesPerMonth:s,totalFeesWithoutRebate:v,totalFeesWithRebate:v-b},projections:{lowVolume:i(5e5,a,l,15),currentVolume:i(t,a,l,s),highVolume:i(2*t,a,l,1.5*s)}}})}catch(e){return console.error("Calculator API error:",e),h.NextResponse.json({error:"Failed to calculate rebate"},{status:500})}}function i(e,r,t,a){let l=n[r],s=l.vipLevels.slice().reverse().find(r=>e>=r.threshold)||l.vipLevels[0],o="maker"===t?s.makerFee:s.takerFee,h=e*o*(.1*s.rebateShare);return{volume:e,monthlyRebate:h,yearlyRebate:12*h,vipLevel:s.level}}async function F(e){try{let{volume:r,exchange:t,broker:a,tradeType:l,tradesPerMonth:s,tier:o}=await e.json(),n=a||t||"binance";if(Array.isArray(r)){let e=r.map(e=>d(parseFloat(e.toString()),n,l||"taker",s||20));return h.NextResponse.json({success:!0,data:{results:e,summary:{totalMonthlyRebate:e.reduce((e,r)=>e+r.monthlyRebate,0),totalYearlyRebate:e.reduce((e,r)=>e+r.yearlyRebate,0),averageRebateRate:e.reduce((e,r)=>e+r.rebateRate,0)/e.length}}})}let k=d(r,n,l||"taker",s||20);return h.NextResponse.json({success:!0,data:k})}catch(e){return console.error("Calculator POST error:",e),h.NextResponse.json({error:"Failed to calculate rebate",details:e.message},{status:500})}}function d(e,r,t,a){let l=n[r],s=l.vipLevels.slice().reverse().find(r=>e>=r.threshold)||l.vipLevels[0],o="maker"===t?s.makerFee:s.takerFee,h=.1*s.rebateShare,k=e*o*h;return{volume:e,broker:r,tradeType:t,monthlyRebate:k,yearlyRebate:12*k,feeRate:o,rebateRate:h,vipLevel:s.level}}let v=new l.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/calculator/route",pathname:"/api/calculator",filename:"route",bundlePath:"app/api/calculator/route"},resolvedPagePath:"/Users/macbookprom1/apexrebate-1/src/app/api/calculator/route.ts",nextConfigOutput:"standalone",userland:a}),{workAsyncStorage:u,workUnitAsyncStorage:m,serverHooks:c}=v;function b(){return(0,o.patchFetch)({workAsyncStorage:u,workUnitAsyncStorage:m})}},78335:()=>{},96487:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[7719,580],()=>t(63502));module.exports=a})();