(()=>{var e={};e.id=7482,e.ids=[5069,7482],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},5069:(e,t,a)=>{"use strict";a.d(t,{db:()=>r,prisma:()=>n});var s=a(96330);let r=globalThis.prisma??new s.PrismaClient({log:["query"]}),n=r},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11723:e=>{"use strict";e.exports=require("querystring")},12412:e=>{"use strict";e.exports=require("assert")},12909:(e,t,a)=>{"use strict";a.d(t,{N:()=>c});var s=a(60890),r=a(13581),n=a(36344),i=a(5069),o=a(85663);let c={adapter:(0,s.y)(i.db),providers:[...process.env.GOOGLE_CLIENT_ID&&process.env.GOOGLE_CLIENT_SECRET?[(0,n.A)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET})]:[],(0,r.A)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;let t=await i.db.users.findUnique({where:{email:e.email}});return t&&t.password&&await o.Ay.compare(e.password,t.password)?{id:t.id,email:t.email,name:t.name,role:t.role}:null}})],session:{strategy:"jwt"},callbacks:{jwt:async({token:e,user:t})=>(t&&(e.role=t.role),e),session:async({session:e,token:t})=>(t&&(e.user.id=t.sub,e.user.role=t.role),e)},pages:{signIn:"/auth/signin"}}},13581:(e,t)=>{"use strict";t.A=function(e){return{id:"credentials",name:"Credentials",type:"credentials",credentials:{},authorize:()=>null,options:e}}},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},35549:(e,t,a)=>{"use strict";a.r(t),a.d(t,{patchFetch:()=>E,routeModule:()=>A,serverHooks:()=>U,workAsyncStorage:()=>D,workUnitAsyncStorage:()=>R});var s={};a.r(s),a.d(s,{GET:()=>d,POST:()=>p});var r=a(96559),n=a(48088),i=a(37719),o=a(32190),c=a(19854),u=a(12909),l=a(5069);async function d(e){try{let t=await (0,c.getServerSession)(u.N);if(t?.user?.role!=="ADMIN")return o.NextResponse.json({error:"Unauthorized"},{status:401});let{searchParams:a}=new URL(e.url);switch(a.get("action")){case"regions":return await g();case"deployments":return await m();case"status":return await y();case"metrics":return await w();default:return o.NextResponse.json({error:"Invalid action"},{status:400})}}catch(e){return console.error("Multi-region API error:",e),o.NextResponse.json({error:"Internal server error"},{status:500})}}async function p(e){try{let t=await (0,c.getServerSession)(u.N);if(t?.user?.role!=="ADMIN")return o.NextResponse.json({error:"Unauthorized"},{status:401});let a=await e.json(),{action:s}=a;switch(s){case"add-region":return await h(a.region);case"update-region":return await v(a.regionId,a.updates);case"create-deployment":return await f(a.deployment);case"update-deployment":return await x(a.deploymentId,a.updates);case"trigger-failover":return await b(a.deploymentId,a.targetRegion);case"sync-data":return await k(a.sourceRegion,a.targetRegion);default:return o.NextResponse.json({error:"Invalid action"},{status:400})}}catch(e){return console.error("Multi-region POST error:",e),o.NextResponse.json({error:"Internal server error"},{status:500})}}async function g(){let e=[{id:"us-east-1",name:"US East (N. Virginia)",code:"USE1",endpoint:"https://api.apexrebate.com",status:"active",latency:45,load:65,lastHealthCheck:new Date,capabilities:["trading","analytics","ai","storage"]},{id:"eu-west-1",name:"EU West (Ireland)",code:"EUW1",endpoint:"https://eu-api.apexrebate.com",status:"active",latency:32,load:58,lastHealthCheck:new Date,capabilities:["trading","analytics","storage"]},{id:"ap-southeast-1",name:"Asia Pacific (Singapore)",code:"APSE1",endpoint:"https://ap-api.apexrebate.com",status:"active",latency:28,load:72,lastHealthCheck:new Date,capabilities:["trading","analytics","ai"]},{id:"ap-northeast-1",name:"Asia Pacific (Tokyo)",code:"APNE1",endpoint:"https://jp-api.apexrebate.com",status:"maintenance",latency:25,load:45,lastHealthCheck:new Date,capabilities:["trading","analytics"]}];return o.NextResponse.json({regions:e,total:e.length,active:e.filter(e=>"active"===e.status).length})}async function m(){let e=[{id:"global-primary",name:"Global Primary Deployment",regions:["us-east-1","eu-west-1","ap-southeast-1"],strategy:"geographic",failoverEnabled:!0,healthCheckInterval:30,createdAt:new Date("2024-01-15"),updatedAt:new Date},{id:"asia-backup",name:"Asia Backup Deployment",regions:["ap-southeast-1","ap-northeast-1"],strategy:"performance",failoverEnabled:!0,healthCheckInterval:60,createdAt:new Date("2024-02-01"),updatedAt:new Date}];return o.NextResponse.json({deployments:e,total:e.length})}async function y(){let e={totalRegions:4,activeRegions:3,totalUsers:45230,activeUsers:12450,totalTransactions:892340,systemUptime:"99.98%",averageLatency:32.5,dataSyncStatus:"healthy",lastSync:new Date,alerts:[{id:"1",type:"maintenance",message:"APNE1 region under maintenance",severity:"warning"}]};return o.NextResponse.json(e)}async function w(){return o.NextResponse.json({"us-east-1":{users:18234,transactions:412890,revenue:89234.5,cpuUsage:65,memoryUsage:72,diskUsage:45,networkIn:1024,networkOut:2048},"eu-west-1":{users:15678,transactions:345670,revenue:67890.25,cpuUsage:58,memoryUsage:65,diskUsage:38,networkIn:856,networkOut:1432},"ap-southeast-1":{users:11318,transactions:133780,revenue:45678.75,cpuUsage:72,memoryUsage:78,diskUsage:52,networkIn:678,networkOut:987}})}async function h(e){let t={id:e.id||`region-${Date.now()}`,name:e.name||"New Region",code:e.code||"NEW",endpoint:e.endpoint||"",status:"inactive",latency:0,load:0,lastHealthCheck:new Date,capabilities:e.capabilities||[]};try{await l.db.deploymentRegion.create({data:{id:t.id,name:t.name,code:t.code,endpoint:t.endpoint,status:t.status,capabilities:t.capabilities,createdAt:new Date,updatedAt:new Date}})}catch(e){console.log("Region data saved (simulated)")}return o.NextResponse.json({success:!0,region:t,message:"Region added successfully"})}async function v(e,t){try{await l.db.deploymentRegion.update({where:{id:e},data:{...t,updatedAt:new Date}})}catch(e){console.log("Region updated (simulated)")}return o.NextResponse.json({success:!0,message:"Region updated successfully"})}async function f(e){let t={id:e.id||`deployment-${Date.now()}`,name:e.name||"New Deployment",regions:e.regions||[],strategy:e.strategy||"round-robin",failoverEnabled:e.failoverEnabled||!1,healthCheckInterval:e.healthCheckInterval||30,createdAt:new Date,updatedAt:new Date};try{await l.db.deploymentConfig.create({data:{id:t.id,name:t.name,regions:t.regions,strategy:t.strategy,failoverEnabled:t.failoverEnabled,healthCheckInterval:t.healthCheckInterval,createdAt:t.createdAt,updatedAt:t.updatedAt}})}catch(e){console.log("Deployment created (simulated)")}return o.NextResponse.json({success:!0,deployment:t,message:"Deployment created successfully"})}async function x(e,t){try{await l.db.deploymentConfig.update({where:{id:e},data:{...t,updatedAt:new Date}})}catch(e){console.log("Deployment updated (simulated)")}return o.NextResponse.json({success:!0,message:"Deployment updated successfully"})}async function b(e,t){try{await l.db.failoverEvent.create({data:{deploymentId:e,sourceRegion:"auto-detected",targetRegion:t,reason:"manual_trigger",status:"initiated",initiatedAt:new Date,completedAt:null}})}catch(e){console.log("Failover event recorded (simulated)")}return setTimeout(async()=>{try{await l.db.failoverEvent.updateMany({where:{deploymentId:e},data:{status:"completed",completedAt:new Date}})}catch(e){console.log("Failover completed (simulated)")}},5e3),o.NextResponse.json({success:!0,message:"Failover initiated successfully",deploymentId:e,targetRegion:t})}async function k(e,t){let a=`sync-${Date.now()}`;try{await l.db.dataSync.create({data:{id:a,sourceRegion:e,targetRegion:t,status:"pending",initiatedAt:new Date,completedAt:null,recordsProcessed:0,recordsTotal:0}})}catch(e){console.log("Data sync task created (simulated)")}return setTimeout(async()=>{try{await l.db.dataSync.update({where:{id:a},data:{status:"completed",completedAt:new Date,recordsProcessed:15420,recordsTotal:15420}})}catch(e){console.log("Data sync completed (simulated)")}},8e3),o.NextResponse.json({success:!0,syncId:a,message:"Data sync initiated successfully"})}let A=new r.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/multi-region/route",pathname:"/api/multi-region",filename:"route",bundlePath:"app/api/multi-region/route"},resolvedPagePath:"/Users/macbookprom1/apexrebate-1/src/app/api/multi-region/route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:D,workUnitAsyncStorage:R,serverHooks:U}=A;function E(){return(0,i.patchFetch)({workAsyncStorage:D,workUnitAsyncStorage:R})}},36344:(e,t)=>{"use strict";t.A=function(e){return{id:"google",name:"Google",type:"oauth",wellKnown:"https://accounts.google.com/.well-known/openid-configuration",authorization:{params:{scope:"openid email profile"}},idToken:!0,checks:["pkce","state"],profile:e=>({id:e.sub,name:e.name,email:e.email,image:e.picture}),style:{logo:"/google.svg",bg:"#fff",text:"#000"},options:e}}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},60890:(e,t)=>{"use strict";t.y=void 0,t.y=function(e){return{createUser:t=>e.user.create({data:t}),getUser:t=>e.user.findUnique({where:{id:t}}),getUserByEmail:t=>e.user.findUnique({where:{email:t}}),async getUserByAccount(t){var a;let s=await e.account.findUnique({where:{provider_providerAccountId:t},select:{user:!0}});return null!=(a=null==s?void 0:s.user)?a:null},updateUser:({id:t,...a})=>e.user.update({where:{id:t},data:a}),deleteUser:t=>e.user.delete({where:{id:t}}),linkAccount:t=>e.account.create({data:t}),unlinkAccount:t=>e.account.delete({where:{provider_providerAccountId:t}}),async getSessionAndUser(t){let a=await e.session.findUnique({where:{sessionToken:t},include:{user:!0}});if(!a)return null;let{user:s,...r}=a;return{user:s,session:r}},createSession:t=>e.session.create({data:t}),updateSession:t=>e.session.update({where:{sessionToken:t.sessionToken},data:t}),deleteSession:t=>e.session.delete({where:{sessionToken:t}}),async createVerificationToken(t){let a=await e.verificationToken.create({data:t});return a.id&&delete a.id,a},async useVerificationToken(t){try{let a=await e.verificationToken.delete({where:{identifier_token:t}});return a.id&&delete a.id,a}catch(e){if("P2025"===e.code)return null;throw e}}}}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},94735:e=>{"use strict";e.exports=require("events")},96330:e=>{"use strict";e.exports=require("@prisma/client")},96487:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[7719,580,4999,8044,9854],()=>a(35549));module.exports=s})();