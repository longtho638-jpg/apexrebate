(()=>{var e={};e.id=2312,e.ids=[2312],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},8719:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{isRequestAPICallableInsideAfter:function(){return c},throwForSearchParamsAccessInUseCache:function(){return o},throwWithStaticGenerationBailoutError:function(){return n},throwWithStaticGenerationBailoutErrorWithDynamicError:function(){return i}});let r=a(80023),s=a(3295);function n(e,t){throw Object.defineProperty(new r.StaticGenBailoutError(`Route ${e} couldn't be rendered statically because it used ${t}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E576",enumerable:!1,configurable:!0})}function i(e,t){throw Object.defineProperty(new r.StaticGenBailoutError(`Route ${e} with \`dynamic = "error"\` couldn't be rendered statically because it used ${t}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E543",enumerable:!1,configurable:!0})}function o(e){let t=Object.defineProperty(Error(`Route ${e.route} used "searchParams" inside "use cache". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use "searchParams" outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E634",enumerable:!1,configurable:!0});throw e.invalidUsageError??=t,t}function c(){let e=s.afterTaskAsyncStorage.getStore();return(null==e?void 0:e.rootTaskSpawnPhase)==="action"}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},15258:(e,t,a)=>{"use strict";a.r(t),a.d(t,{patchFetch:()=>w,routeModule:()=>f,serverHooks:()=>b,workAsyncStorage:()=>E,workUnitAsyncStorage:()=>k});var r={};a.r(r),a.d(r,{GET:()=>g,POST:()=>y});var s=a(96559),n=a(48088),i=a(37719),o=a(32190),c=a(55511);class l{constructor(e,t,a){this.name=e,this.baseUrl=t,this.credentials=a,this.isSandbox=a.sandbox||!1}getName(){return this.name}isTestMode(){return this.isSandbox}normalizeSymbol(e){return e.toUpperCase().replace("-","/")}calculateRebate(e,t){return e.fee*(.3*t.maker)}generateSignature(e,t){return c.createHmac("sha256",t).update(e).digest("hex")}async makeRequest(e,t="GET",a,r){let s=`${this.baseUrl}${e}`,n={method:t,headers:{"Content-Type":"application/json","User-Agent":"ApexRebate/1.0",...r}};a&&"GET"!==t&&(n.body=JSON.stringify(a));try{let e=await fetch(s,n);if(!e.ok)throw Error(`API请求失败: ${e.status} ${e.statusText}`);return await e.json()}catch(e){throw console.error(`${this.name} API请求错误:`,e),e}}handleError(e){let t=e.response?.data?.message||e.message||"未知错误";throw Error(`${this.name} API错误: ${t}`)}async handleRateLimit(){await new Promise(e=>setTimeout(e,100))}}class u extends l{constructor(e){super("Coinbase",e.sandbox?"https://api-public.sandbox.pro.coinbase.com":"https://api.pro.coinbase.com",e),this.apiVersion="v2"}async validateCredentials(){try{return await this.makeRequest("/users/self","GET",{},this.getAuthHeaders("GET","/users/self")),!0}catch(e){return console.error("Coinbase凭证验证失败:",e),!1}}async getTradingPairs(){try{return(await this.makeRequest("/products")).data.map(e=>({symbol:e.id,baseAsset:e.base_currency,quoteAsset:e.quote_currency,status:"online"===e.status?"active":"inactive"}))}catch(e){this.handleError(e)}}async getTicker(e){try{let t=await this.makeRequest(`/products/${e}/ticker`),a=await this.makeRequest(`/products/${e}/stats`);return{symbol:e,price:parseFloat(t.price),change24h:0,volume24h:parseFloat(a.volume_24h),high24h:parseFloat(a.high_24h),low24h:parseFloat(a.low_24h),timestamp:Date.now()}}catch(e){this.handleError(e)}}async getTickers(){try{let e=await this.getTradingPairs(),t=[];for(let a of e.filter(e=>"active"===e.status).slice(0,50))try{let e=await this.getTicker(a.symbol);t.push(e),await this.handleRateLimit()}catch(e){console.warn(`获取${a.symbol}价格失败:`,e)}return t}catch(e){this.handleError(e)}}async getFeeStructure(){try{return{maker:.005,taker:.005,levels:[{volume30d:0,maker:.005,taker:.005},{volume30d:1e4,maker:.0035,taker:.0035},{volume30d:1e5,maker:.0025,taker:.0025},{volume30d:1e6,maker:.002,taker:.002},{volume30d:1e7,maker:.0015,taker:.0015},{volume30d:1e8,maker:.001,taker:.001}]}}catch(e){this.handleError(e)}}async getAffiliateInfo(){try{return{affiliateCode:"APEXREBATE",commissionRate:.5,rebateRate:.0025,status:"active"}}catch(e){this.handleError(e)}}async getTransactionHistory(e,t){try{return(await this.makeRequest(`/fills?order_id=all&product_id=all&after=${e.toISOString()}&before=${t.toISOString()}`,"GET",{},this.getAuthHeaders("GET",`/fills?order_id=all&product_id=all&after=${e.toISOString()}&before=${t.toISOString()}`))).data.map(e=>({id:e.trade_id,symbol:e.product_id,side:e.side,amount:parseFloat(e.size),price:parseFloat(e.price),fee:parseFloat(e.fee),timestamp:new Date(e.created_at).getTime(),orderId:e.order_id}))}catch(e){this.handleError(e)}}async getBalances(){try{return(await this.makeRequest("/accounts","GET",{},this.getAuthHeaders("GET","/accounts"))).data.filter(e=>parseFloat(e.balance)>0).map(e=>({asset:e.currency,free:parseFloat(e.available),locked:parseFloat(e.hold),total:parseFloat(e.balance)}))}catch(e){this.handleError(e)}}getAuthHeaders(e,t,a){let r=Math.floor(Date.now()/1e3),s=r+e+t+(a||""),n=this.generateSignature(s,this.credentials.secret);return{"CB-ACCESS-KEY":this.credentials.apiKey,"CB-ACCESS-SIGN":n,"CB-ACCESS-TIMESTAMP":r.toString(),"CB-ACCESS-PASSPHRASE":this.credentials.passphrase||""}}async getAccountHistory(e){try{return(await this.makeRequest(`/accounts/${e}/ledger`,"GET",{},this.getAuthHeaders("GET",`/accounts/${e}/ledger`))).data}catch(e){this.handleError(e)}}async getOrderHistory(e){try{let t="/orders";return e&&(t+=`?status=${e}`),(await this.makeRequest(t,"GET",{},this.getAuthHeaders("GET",t))).data}catch(e){this.handleError(e)}}async handleRateLimit(){await new Promise(e=>setTimeout(e,350))}}class h extends l{constructor(e){super("Kraken",(e.sandbox,"https://api.kraken.com/0"),e)}async validateCredentials(){try{let e=await this.makeAuthenticatedRequest("Balance");return 0===e.error.length}catch(e){return console.error("Kraken凭证验证失败:",e),!1}}async getTradingPairs(){try{let e=await this.makeRequest("/public/AssetPairs"),t=[];return Object.entries(e.result).forEach(([e,a])=>{e.endsWith(".d")||t.push({symbol:e,baseAsset:a.base,quoteAsset:a.quote,status:"active"})}),t}catch(e){this.handleError(e)}}async getTicker(e){try{let t=(await this.makeRequest(`/public/Ticker?pair=${e}`)).result[e];if(!t)throw Error(`找不到交易对 ${e} 的价格数据`);let[a,,r,s,,n]=t.c||[0,0,0,0,0,0];return{symbol:e,price:parseFloat(a),change24h:0,volume24h:parseFloat(n||"0"),high24h:parseFloat(s||"0"),low24h:parseFloat(r||"0"),timestamp:Date.now()}}catch(e){this.handleError(e)}}async getTickers(){try{let e=await this.getTradingPairs(),t=[],a=e.filter(e=>"USD"===e.quoteAsset||"EUR"===e.quoteAsset||"BTC"===e.quoteAsset||"ETH"===e.quoteAsset).slice(0,50).map(e=>e.symbol).join(","),r=await this.makeRequest(`/public/Ticker?pair=${a}`);return Object.entries(r.result).forEach(([e,a])=>{let[r,,s,n,,i]=a.c||[0,0,0,0,0,0];t.push({symbol:e,price:parseFloat(r),change24h:0,volume24h:parseFloat(i||"0"),high24h:parseFloat(n||"0"),low24h:parseFloat(s||"0"),timestamp:Date.now()})}),t}catch(e){this.handleError(e)}}async getFeeStructure(){try{return{maker:.0016,taker:.0026,levels:[{volume30d:0,maker:.0016,taker:.0026},{volume30d:5e4,maker:.0014,taker:.0024},{volume30d:1e5,maker:.0012,taker:.0022},{volume30d:25e4,maker:.001,taker:.002},{volume30d:5e5,maker:8e-4,taker:.0018},{volume30d:1e6,maker:6e-4,taker:.0016},{volume30d:25e5,maker:4e-4,taker:.0014},{volume30d:5e6,maker:2e-4,taker:.0012},{volume30d:1e7,maker:0,taker:.001}]}}catch(e){this.handleError(e)}}async getAffiliateInfo(){try{return{affiliateCode:"APEXREBATE",commissionRate:.2,rebateRate:52e-5,status:"active"}}catch(e){this.handleError(e)}}async getTransactionHistory(e,t){try{let a=await this.makeAuthenticatedRequest("TradesHistory",{start:Math.floor(e.getTime()/1e3),end:Math.floor(t.getTime()/1e3)}),r=[];return a.result&&a.result.trades&&Object.entries(a.result.trades).forEach(([e,t])=>{r.push({id:e,symbol:t.pair,side:t.type,amount:parseFloat(t.vol),price:parseFloat(t.price),fee:parseFloat(t.fee),timestamp:1e3*parseInt(t.time),orderId:t.ordertxid||e})}),r}catch(e){this.handleError(e)}}async getBalances(){try{let e=await this.makeAuthenticatedRequest("Balance"),t=[];return e.result&&Object.entries(e.result).forEach(([e,a])=>{let r=parseFloat(a);r>0&&t.push({asset:e,free:r,locked:0,total:r})}),t}catch(e){this.handleError(e)}}async makeAuthenticatedRequest(e,t){let a=Date.now().toString(),r=t?new URLSearchParams({...t,nonce:a}).toString():`nonce=${a}`,s=a+r,n=this.generateSignature(s,this.credentials.secret),i={"API-Key":this.credentials.apiKey,"API-Sign":n,"Content-Type":"application/x-www-form-urlencoded"};return this.makeRequest(`/private/${e}`,"POST",r,i)}async getBalanceDetails(){try{return await this.makeAuthenticatedRequest("Balance")}catch(e){this.handleError(e)}}async getTradeHistory(e){try{let t={};return e?.start&&(t.start=Math.floor(e.start.getTime()/1e3)),e?.end&&(t.end=Math.floor(e.end.getTime()/1e3)),e?.offset&&(t.offset=e.offset),await this.makeAuthenticatedRequest("TradesHistory",t)}catch(e){this.handleError(e)}}async getOrderHistory(e){try{let t={};return e?.start&&(t.start=Math.floor(e.start.getTime()/1e3)),e?.end&&(t.end=Math.floor(e.end.getTime()/1e3)),e?.offset&&(t.offset=e.offset),await this.makeAuthenticatedRequest("ClosedOrders",t)}catch(e){this.handleError(e)}}generateSignature(e,t){return c.createHmac("sha512",Buffer.from(t,"base64")).update(e).digest("base64")}async handleRateLimit(){await new Promise(e=>setTimeout(e,1100))}}class d extends l{constructor(e){super("KuCoin",e.sandbox?"https://openapi-sandbox.kucoin.com":"https://api.kucoin.com",e),this.apiVersion="v1",this.apiKeyVersion="2",this.passphrase=e.passphrase||""}async validateCredentials(){try{return await this.makeAuthenticatedRequest("GET","/api/v1/accounts"),!0}catch(e){return console.error("KuCoin凭证验证失败:",e),!1}}async getTradingPairs(){try{return(await this.makeRequest("/api/v1/symbols")).data.map(e=>({symbol:e.symbol,baseAsset:e.baseCurrency,quoteAsset:e.quoteCurrency,status:e.enableTrading?"active":"inactive"}))}catch(e){this.handleError(e)}}async getTicker(e){try{let t=await this.makeRequest(`/api/v1/market/orderbook/level1?symbol=${e}`);return{symbol:e,price:parseFloat(t.data.price),change24h:parseFloat(t.data.changeRate||"0"),volume24h:parseFloat(t.data.vol||"0"),high24h:parseFloat(t.data.high||"0"),low24h:parseFloat(t.data.low||"0"),timestamp:parseInt(t.data.time)}}catch(e){this.handleError(e)}}async getTickers(){try{return(await this.makeRequest("/api/v1/market/allTickers")).data.ticker.filter(e=>e.symbol.includes("-")).slice(0,100).map(e=>({symbol:e.symbol,price:parseFloat(e.last||"0"),change24h:parseFloat(e.changeRate||"0"),volume24h:parseFloat(e.vol||"0"),high24h:parseFloat(e.high||"0"),low24h:parseFloat(e.low||"0"),timestamp:Date.now()}))}catch(e){this.handleError(e)}}async getFeeStructure(){try{return{maker:.001,taker:.001,levels:[{volume30d:0,maker:.001,taker:.001},{volume30d:1e3,maker:9e-4,taker:.001},{volume30d:1e4,maker:8e-4,taker:.001},{volume30d:5e4,maker:7e-4,taker:.001},{volume30d:1e5,maker:6e-4,taker:.001},{volume30d:5e5,maker:5e-4,taker:.001},{volume30d:1e6,maker:4e-4,taker:.001},{volume30d:2e6,maker:3e-4,taker:.001},{volume30d:5e6,maker:2e-4,taker:.001},{volume30d:1e7,maker:1e-4,taker:.001}]}}catch(e){this.handleError(e)}}async getAffiliateInfo(){try{return{affiliateCode:"APEXREBATE",commissionRate:.4,rebateRate:4e-4,status:"active"}}catch(e){this.handleError(e)}}async getTransactionHistory(e,t){try{return(await this.makeAuthenticatedRequest("GET","/api/v1/fills",{startAt:Math.floor(e.getTime()/1e3),endAt:Math.floor(t.getTime()/1e3)})).data.items.map(e=>({id:e.id,symbol:e.symbol,side:e.side,amount:parseFloat(e.size),price:parseFloat(e.price),fee:parseFloat(e.fee),timestamp:parseInt(e.createdAt),orderId:e.orderId}))}catch(e){this.handleError(e)}}async getBalances(){try{return(await this.makeAuthenticatedRequest("GET","/api/v1/accounts")).data.filter(e=>"trade"===e.type&&parseFloat(e.balance)>0).map(e=>({asset:e.currency,free:parseFloat(e.available),locked:parseFloat(e.holds),total:parseFloat(e.balance)}))}catch(e){this.handleError(e)}}async makeAuthenticatedRequest(e,t,a){let r=Date.now().toString(),s=a?new URLSearchParams(a).toString():"",n=this.generateSignature(r+e+t+s,this.credentials.secret),i={"KC-API-KEY":this.credentials.apiKey,"KC-API-SIGN":n,"KC-API-TIMESTAMP":r,"KC-API-PASSPHRASE":this.encryptPassphrase(),"KC-API-KEY-VERSION":this.apiKeyVersion,"Content-Type":"application/json"},o=s?`${t}?${s}`:t;return this.makeRequest(o,e,void 0,i)}encryptPassphrase(){return c.createHmac("sha256",this.credentials.secret).update(this.passphrase).digest("base64")}async get24hrStats(e){try{return await this.makeRequest(`/api/v1/market/stats?symbol=${e}`)}catch(e){this.handleError(e)}}async getOrderHistory(e){try{let t={};return e?.symbol&&(t.symbol=e.symbol),e?.status&&(t.status=e.status),e?.page&&(t.currentPage=e.page),await this.makeAuthenticatedRequest("GET","/api/v1/orders",t)}catch(e){this.handleError(e)}}async getRecentTrades(e){try{return await this.makeRequest(`/api/v1/market/histories?symbol=${e}`)}catch(e){this.handleError(e)}}async getKlines(e,t="1min"){try{return await this.makeRequest(`/api/v1/market/candles?type=${t}&symbol=${e}`)}catch(e){this.handleError(e)}}async handleRateLimit(){await new Promise(e=>setTimeout(e,50))}async getServerTime(){try{return(await this.makeRequest("/api/v1/timestamp")).data}catch(e){this.handleError(e)}}async getSystemStatus(){try{return await this.makeRequest("/api/v1/status")}catch(e){this.handleError(e)}}}class p{constructor(){this.exchanges=new Map,this.configs=new Map,this.metrics=new Map,this.updateInterval=null,this.initializeDefaultExchanges()}initializeDefaultExchanges(){[{name:"Binance",enabled:!0,credentials:{apiKey:process.env.BINANCE_API_KEY||"",secret:process.env.BINANCE_SECRET||"",sandbox:!1},priority:1,supportedPairs:["BTC/USDT","ETH/USDT","BNB/USDT"]},{name:"Bybit",enabled:!0,credentials:{apiKey:process.env.BYBIT_API_KEY||"",secret:process.env.BYBIT_SECRET||"",sandbox:!1},priority:2,supportedPairs:["BTC/USDT","ETH/USDT","SOL/USDT"]},{name:"Coinbase",enabled:!0,credentials:{apiKey:process.env.COINBASE_API_KEY||"",secret:process.env.COINBASE_SECRET||"",passphrase:process.env.COINBASE_PASSPHRASE||"",sandbox:!1},priority:3,supportedPairs:["BTC-USD","ETH-USD","SOL-USD"]},{name:"Kraken",enabled:!0,credentials:{apiKey:process.env.KRAKEN_API_KEY||"",secret:process.env.KRAKEN_SECRET||"",sandbox:!1},priority:4,supportedPairs:["XXBTZUSD","XETHZUSD","SOLUSD"]},{name:"KuCoin",enabled:!0,credentials:{apiKey:process.env.KUCOIN_API_KEY||"",secret:process.env.KUCOIN_SECRET||"",passphrase:process.env.KUCOIN_PASSPHRASE||"",sandbox:!1},priority:5,supportedPairs:["BTC-USDT","ETH-USDT","SOL-USDT"]}].forEach(e=>{this.configs.set(e.name,e),e.enabled&&this.initializeExchange(e)})}initializeExchange(e){try{let t;switch(e.name){case"Coinbase":t=new u(e.credentials);break;case"Kraken":t=new h(e.credentials);break;case"KuCoin":t=new d(e.credentials);break;default:console.warn(`交易所 ${e.name} 尚未实现`);return}this.exchanges.set(e.name,t),this.metrics.set(e.name,{name:e.name,status:"online",lastUpdate:Date.now(),responseTime:0,tickersCount:0,pairsCount:0,errorCount:0}),console.log(`交易所 ${e.name} 初始化成功`)}catch(t){console.error(`交易所 ${e.name} 初始化失败:`,t),this.updateMetrics(e.name,"error",0,0,0)}}async addExchange(e){try{if(this.configs.set(e.name,e),e.enabled){this.initializeExchange(e);let t=this.exchanges.get(e.name);if(t&&!await t.validateCredentials())throw Error("凭证验证失败")}return!0}catch(t){return console.error(`添加交易所 ${e.name} 失败:`,t),!1}}removeExchange(e){try{return this.exchanges.delete(e),this.configs.delete(e),this.metrics.delete(e),!0}catch(t){return console.error(`移除交易所 ${e} 失败:`,t),!1}}getExchanges(){return Array.from(this.exchanges.values())}getExchange(e){return this.exchanges.get(e)}async getAllTradingPairs(){let e=[];for(let[t,a]of this.exchanges)try{let r=await a.getTradingPairs();e.push(...r.map(e=>({...e,exchange:t})))}catch(e){console.error(`获取 ${t} 交易对失败:`,e),this.updateMetrics(t,"error",0,0,0)}return e}async getAggregatedTickers(e){let t=new Map;for(let[a,r]of this.exchanges)try{let s=Date.now(),n=e?await Promise.all(e.map(e=>r.getTicker(e))):await r.getTickers(),i=Date.now()-s;n.forEach(e=>{let r=t.get(e.symbol)||{symbol:e.symbol,exchanges:[],averagePrice:0,totalVolume24h:0,bestPrice:0,bestExchange:"",priceSpread:0};r.exchanges.push({name:a,price:e.price,volume24h:e.volume24h,change24h:e.change24h}),t.set(e.symbol,r)}),this.updateMetrics(a,"online",i,n.length,0)}catch(e){console.error(`获取 ${a} 价格数据失败:`,e),this.updateMetrics(a,"error",0,0,1)}let a=[];for(let[e,r]of t){let e=r.exchanges.map(e=>e.price),t=r.exchanges.map(e=>e.volume24h),s=Math.max(...e),n=r.exchanges.find(e=>e.price===s)?.name||"",i=Math.max(...e)-Math.min(...e),o=e.reduce((e,t)=>e+t,0)/e.length,c=t.reduce((e,t)=>e+t,0);a.push({...r,averagePrice:o,totalVolume24h:c,bestPrice:s,bestExchange:n,priceSpread:i})}return a}async getAllFeeStructures(){let e=new Map;for(let[t,a]of this.exchanges)try{let r=await a.getFeeStructure();e.set(t,r)}catch(e){console.error(`获取 ${t} 费率结构失败:`,e)}return e}async getAllAffiliateInfo(){let e=new Map;for(let[t,a]of this.exchanges)try{let r=await a.getAffiliateInfo();e.set(t,r)}catch(e){console.error(`获取 ${t} 联盟信息失败:`,e)}return e}getExchangeMetrics(){return Array.from(this.metrics.values())}updateMetrics(e,t,a,r,s){let n=this.metrics.get(e);n&&this.metrics.set(e,{...n,status:t,lastUpdate:Date.now(),responseTime:a,tickersCount:r,errorCount:n.errorCount+s})}startAutoUpdate(e=6e4){this.updateInterval&&clearInterval(this.updateInterval),this.updateInterval=setInterval(async()=>{await this.updateAllMetrics()},e),console.log("交易所自动更新已启动")}stopAutoUpdate(){this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null,console.log("交易所自动更新已停止"))}async updateAllMetrics(){for(let[e,t]of this.exchanges)try{let a=Date.now();await t.getTickers();let r=Date.now()-a;this.updateMetrics(e,"online",r,0,0)}catch(t){console.error(`更新 ${e} 指标失败:`,t),this.updateMetrics(e,"error",0,0,1)}}async healthCheck(){let e=new Map;for(let[t,a]of this.exchanges)try{let r=await a.validateCredentials();e.set(t,r)}catch(a){e.set(t,!1)}return e}getConfigs(){return Array.from(this.configs.values())}updateConfig(e,t){try{let a=this.configs.get(e);if(a){let r={...a,...t};return this.configs.set(e,r),r.enabled&&!this.exchanges.has(e)?this.initializeExchange(r):!r.enabled&&this.exchanges.has(e)&&this.exchanges.delete(e),!0}return!1}catch(t){return console.error(`更新 ${e} 配置失败:`,t),!1}}}let m=new p;async function g(e){try{let{searchParams:t}=new URL(e.url),a=t.get("action"),r=t.get("exchange"),s=t.get("symbol"),n=t.get("symbols")?.split(",");switch(a){case"exchanges":let i=m.getExchanges();return o.NextResponse.json({success:!0,data:i.map(e=>({name:e.getName(),testMode:e.isTestMode()}))});case"extended-exchanges":let c=m.getExchanges();return o.NextResponse.json({success:!0,data:c});case"metrics":let l=m.getExchangeMetrics();return o.NextResponse.json({success:!0,data:l});case"tickers":let u=await m.getAggregatedTickers(n);return o.NextResponse.json({success:!0,data:u});case"pairs":let h=await m.getAllTradingPairs();return o.NextResponse.json({success:!0,data:h});case"fees":let d=await m.getAllFeeStructures();return o.NextResponse.json({success:!0,data:Object.fromEntries(d)});case"affiliate":let p=await m.getAllAffiliateInfo();return o.NextResponse.json({success:!0,data:Object.fromEntries(p)});case"health":let g=await m.healthCheck();return o.NextResponse.json({success:!0,data:Object.fromEntries(g)});case"configs":let y=m.getConfigs();return o.NextResponse.json({success:!0,data:y});case"market-data":if(!r||!s)return o.NextResponse.json({success:!1,error:"缺少交易所或交易对参数"},{status:400});return o.NextResponse.json({success:!0,data:{bids:[],asks:[]}});case"trading-history":if(!r||!s)return o.NextResponse.json({success:!1,error:"缺少交易所或交易对参数"},{status:400});return o.NextResponse.json({success:!0,data:[]});case"market-stats":if(!r||!s)return o.NextResponse.json({success:!1,error:"缺少交易所或交易对参数"},{status:400});return o.NextResponse.json({success:!0,data:{}});default:if(r&&s){let e=m.getExchange(r);if(!e)return o.NextResponse.json({success:!1,error:"交易所不存在"},{status:404});let t=await e.getTicker(s);return o.NextResponse.json({success:!0,data:t})}if(!r)return o.NextResponse.json({success:!1,error:"请指定action参数"},{status:400});{let e=m.getExchange(r);if(!e)return o.NextResponse.json({success:!1,error:"交易所不存在"},{status:404});let t=await e.getTickers();return o.NextResponse.json({success:!0,data:t})}}}catch(e){return console.error("交易所API错误:",e),o.NextResponse.json({success:!1,error:e instanceof Error?e.message:"服务器内部错误"},{status:500})}}async function y(e){try{let t=await e.json(),{action:a,exchange:r,config:s}=t;switch(a){case"add":if(!s)return o.NextResponse.json({success:!1,error:"缺少配置信息"},{status:400});let n=await m.addExchange(s);return o.NextResponse.json({success:n,message:n?"交易所添加成功":"交易所添加失败"});case"remove":if(!r)return o.NextResponse.json({success:!1,error:"缺少交易所名称"},{status:400});let i=m.removeExchange(r);return o.NextResponse.json({success:i,message:i?"交易所移除成功":"交易所移除失败"});case"update":if(!r||!s)return o.NextResponse.json({success:!1,error:"缺少交易所名称或配置信息"},{status:400});let c=m.updateConfig(r,s);return o.NextResponse.json({success:c,message:c?"配置更新成功":"配置更新失败"});case"start-auto-update":let l=t.interval||6e4;return m.startAutoUpdate(l),o.NextResponse.json({success:!0,message:"自动更新已启动"});case"stop-auto-update":return m.stopAutoUpdate(),o.NextResponse.json({success:!0,message:"自动更新已停止"});default:return o.NextResponse.json({success:!1,error:"未知操作"},{status:400})}}catch(e){return console.error("交易所API错误:",e),o.NextResponse.json({success:!1,error:e instanceof Error?e.message:"服务器内部错误"},{status:500})}}let f=new s.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/exchanges/route",pathname:"/api/exchanges",filename:"route",bundlePath:"app/api/exchanges/route"},resolvedPagePath:"/Users/macbookprom1/apexrebate-1/src/app/api/exchanges/route.ts",nextConfigOutput:"standalone",userland:r}),{workAsyncStorage:E,workUnitAsyncStorage:k,serverHooks:b}=f;function w(){return(0,i.patchFetch)({workAsyncStorage:E,workUnitAsyncStorage:k})}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},43763:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ReflectAdapter",{enumerable:!0,get:function(){return a}});class a{static get(e,t,a){let r=Reflect.get(e,t,a);return"function"==typeof r?r.bind(e):r}static set(e,t,a,r){return Reflect.set(e,t,a,r)}static has(e,t){return Reflect.has(e,t)}static deleteProperty(e,t){return Reflect.deleteProperty(e,t)}}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96487:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[7719,580],()=>a(15258));module.exports=r})();