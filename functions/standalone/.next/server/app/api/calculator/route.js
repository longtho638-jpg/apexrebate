(()=>{var e={};e.id=7470,e.ids=[7470],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},8719:(e,r,t)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),!function(e,r){for(var t in r)Object.defineProperty(e,t,{enumerable:!0,get:r[t]})}(r,{isRequestAPICallableInsideAfter:function(){return i},throwForSearchParamsAccessInUseCache:function(){return n},throwWithStaticGenerationBailoutError:function(){return l},throwWithStaticGenerationBailoutErrorWithDynamicError:function(){return o}});let a=t(80023),s=t(3295);function l(e,r){throw Object.defineProperty(new a.StaticGenBailoutError(`Route ${e} couldn't be rendered statically because it used ${r}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E576",enumerable:!1,configurable:!0})}function o(e,r){throw Object.defineProperty(new a.StaticGenBailoutError(`Route ${e} with \`dynamic = "error"\` couldn't be rendered statically because it used ${r}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E543",enumerable:!1,configurable:!0})}function n(e){let r=Object.defineProperty(Error(`Route ${e.route} used "searchParams" inside "use cache". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use "searchParams" outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E634",enumerable:!1,configurable:!0});throw e.invalidUsageError??=r,r}function i(){let e=s.afterTaskAsyncStorage.getStore();return(null==e?void 0:e.rootTaskSpawnPhase)==="action"}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},43763:(e,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ReflectAdapter",{enumerable:!0,get:function(){return t}});class t{static get(e,r,t){let a=Reflect.get(e,r,t);return"function"==typeof a?a.bind(e):a}static set(e,r,t,a){return Reflect.set(e,r,t,a)}static has(e,r){return Reflect.has(e,r)}static deleteProperty(e,r){return Reflect.deleteProperty(e,r)}}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63502:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>v,routeModule:()=>k,serverHooks:()=>b,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>p});var a={};t.r(a),t.d(a,{GET:()=>h,POST:()=>u});var s=t(96559),l=t(48088),o=t(37719),n=t(32190);let i={binance:{name:"Binance",makerFee:2e-4,takerFee:4e-4,vipLevels:[{level:"VIP 0",threshold:0,makerFee:2e-4,takerFee:4e-4,rebateShare:.4},{level:"VIP 1",threshold:1e6,makerFee:19e-5,takerFee:38e-5,rebateShare:.45},{level:"VIP 2",threshold:5e6,makerFee:18e-5,takerFee:36e-5,rebateShare:.5},{level:"VIP 3",threshold:25e6,makerFee:17e-5,takerFee:34e-5,rebateShare:.55},{level:"VIP 4",threshold:1e8,makerFee:16e-5,takerFee:32e-5,rebateShare:.6},{level:"VIP 5",threshold:25e7,makerFee:15e-5,takerFee:3e-4,rebateShare:.65},{level:"VIP 6",threshold:1e9,makerFee:14e-5,takerFee:28e-5,rebateShare:.7},{level:"VIP 7",threshold:25e8,makerFee:13e-5,takerFee:26e-5,rebateShare:.75},{level:"VIP 8",threshold:5e9,makerFee:12e-5,takerFee:24e-5,rebateShare:.8},{level:"VIP 9",threshold:1e10,makerFee:1e-4,takerFee:2e-4,rebateShare:.85}]},bybit:{name:"Bybit",makerFee:1e-4,takerFee:6e-4,vipLevels:[{level:"VIP 0",threshold:0,makerFee:1e-4,takerFee:6e-4,rebateShare:.35},{level:"VIP 1",threshold:1e5,makerFee:9e-5,takerFee:55e-5,rebateShare:.4},{level:"VIP 2",threshold:5e5,makerFee:8e-5,takerFee:5e-4,rebateShare:.45},{level:"VIP 3",threshold:25e5,makerFee:7e-5,takerFee:45e-5,rebateShare:.5},{level:"VIP 4",threshold:1e7,makerFee:6e-5,takerFee:4e-4,rebateShare:.55},{level:"VIP 5",threshold:5e7,makerFee:5e-5,takerFee:35e-5,rebateShare:.6},{level:"VIP 6",threshold:2e8,makerFee:4e-5,takerFee:3e-4,rebateShare:.65},{level:"VIP 7",threshold:5e8,makerFee:3e-5,takerFee:25e-5,rebateShare:.7},{level:"VIP 8",threshold:1e9,makerFee:2e-5,takerFee:2e-4,rebateShare:.75},{level:"VIP 9",threshold:2e9,makerFee:1e-5,takerFee:15e-5,rebateShare:.8}]},okx:{name:"OKX",makerFee:8e-4,takerFee:.001,vipLevels:[{level:"VIP 0",threshold:0,makerFee:8e-4,takerFee:.001,rebateShare:.3},{level:"VIP 1",threshold:1e5,makerFee:75e-5,takerFee:95e-5,rebateShare:.35},{level:"VIP 2",threshold:5e5,makerFee:7e-4,takerFee:9e-4,rebateShare:.4},{level:"VIP 3",threshold:1e6,makerFee:65e-5,takerFee:85e-5,rebateShare:.45},{level:"VIP 4",threshold:5e6,makerFee:6e-4,takerFee:8e-4,rebateShare:.5},{level:"VIP 5",threshold:1e7,makerFee:55e-5,takerFee:75e-5,rebateShare:.55},{level:"VIP 6",threshold:5e7,makerFee:5e-4,takerFee:7e-4,rebateShare:.6},{level:"VIP 7",threshold:1e8,makerFee:45e-5,takerFee:65e-5,rebateShare:.65},{level:"VIP 8",threshold:5e8,makerFee:4e-4,takerFee:6e-4,rebateShare:.7},{level:"VIP 9",threshold:1e9,makerFee:35e-5,takerFee:55e-5,rebateShare:.75}]}};async function h(e){try{let{searchParams:r}=new URL(e.url),t=parseFloat(r.get("volume")||"0"),a=r.get("broker")||"binance",s=r.get("tradeType")||"taker",l=parseInt(r.get("tradesPerMonth")||"20");if(t<=0)return n.NextResponse.json({error:"Trading volume must be greater than 0"},{status:400});if(!i[a])return n.NextResponse.json({error:"Invalid broker specified"},{status:400});let o=i[a],h=o.vipLevels.slice().reverse().find(e=>t>=e.threshold)||o.vipLevels[0],u="maker"===s?h.makerFee:h.takerFee,d=t*u,k=12*d,m=h.rebateShare,p=.1*m,b=d*p,v=k*p,F=t/l,y=F*u,f=b/d*100;return n.NextResponse.json({success:!0,data:{input:{volume:t,broker:a,tradeType:s,tradesPerMonth:l},broker:{name:o.name,vipLevel:h.level,makerFee:h.makerFee,takerFee:h.takerFee,brokerRebateShare:h.rebateShare},fees:{monthly:d,yearly:k,feeRate:u,feePerTrade:y,effectiveFeeRate:u-u*p},rebates:{monthly:b,yearly:v,rebateRate:p,rebatePerTrade:y*p,savingsPercentage:f},savings:{monthly:b,yearly:v,totalYearly:v},metrics:{averageTradeSize:F,tradesPerMonth:l,totalFeesWithoutRebate:k,totalFeesWithRebate:k-v},projections:{lowVolume:c(5e5,a,s,15),currentVolume:c(t,a,s,l),highVolume:c(2*t,a,s,1.5*l)}}})}catch(e){return console.error("Calculator API error:",e),n.NextResponse.json({error:"Failed to calculate rebate"},{status:500})}}function c(e,r,t,a){let s=i[r],l=s.vipLevels.slice().reverse().find(r=>e>=r.threshold)||s.vipLevels[0],o="maker"===t?l.makerFee:l.takerFee,n=e*o*(.1*l.rebateShare);return{volume:e,monthlyRebate:n,yearlyRebate:12*n,vipLevel:l.level}}async function u(e){try{let{volume:r,exchange:t,broker:a,tradeType:s,tradesPerMonth:l,tier:o}=await e.json(),i=a||t||"binance";if(Array.isArray(r)){let e=r.map(e=>d(parseFloat(e.toString()),i,s||"taker",l||20));return n.NextResponse.json({success:!0,data:{results:e,summary:{totalMonthlyRebate:e.reduce((e,r)=>e+r.monthlyRebate,0),totalYearlyRebate:e.reduce((e,r)=>e+r.yearlyRebate,0),averageRebateRate:e.reduce((e,r)=>e+r.rebateRate,0)/e.length}}})}let h=d(r,i,s||"taker",l||20);return n.NextResponse.json({success:!0,data:h})}catch(e){return console.error("Calculator POST error:",e),n.NextResponse.json({error:"Failed to calculate rebate",details:e.message},{status:500})}}function d(e,r,t,a){let s=i[r],l=s.vipLevels.slice().reverse().find(r=>e>=r.threshold)||s.vipLevels[0],o="maker"===t?l.makerFee:l.takerFee,n=.1*l.rebateShare,h=e*o*n;return{volume:e,broker:r,tradeType:t,monthlyRebate:h,yearlyRebate:12*h,feeRate:o,rebateRate:n,vipLevel:l.level}}let k=new s.AppRouteRouteModule({definition:{kind:l.RouteKind.APP_ROUTE,page:"/api/calculator/route",pathname:"/api/calculator",filename:"route",bundlePath:"app/api/calculator/route"},resolvedPagePath:"/Users/macbookprom1/apexrebate-1/src/app/api/calculator/route.ts",nextConfigOutput:"standalone",userland:a}),{workAsyncStorage:m,workUnitAsyncStorage:p,serverHooks:b}=k;function v(){return(0,o.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:p})}},78335:()=>{},96487:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[7719,580],()=>t(63502));module.exports=a})();