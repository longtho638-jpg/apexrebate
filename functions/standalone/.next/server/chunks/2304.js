exports.id=2304,exports.ids=[2304],exports.modules={8719:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var i in t)Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}(t,{isRequestAPICallableInsideAfter:function(){return c},throwForSearchParamsAccessInUseCache:function(){return r},throwWithStaticGenerationBailoutError:function(){return n},throwWithStaticGenerationBailoutErrorWithDynamicError:function(){return o}});let s=i(80023),a=i(3295);function n(e,t){throw Object.defineProperty(new s.StaticGenBailoutError(`Route ${e} couldn't be rendered statically because it used ${t}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E576",enumerable:!1,configurable:!0})}function o(e,t){throw Object.defineProperty(new s.StaticGenBailoutError(`Route ${e} with \`dynamic = "error"\` couldn't be rendered statically because it used ${t}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E543",enumerable:!1,configurable:!0})}function r(e){let t=Object.defineProperty(Error(`Route ${e.route} used "searchParams" inside "use cache". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use "searchParams" outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E634",enumerable:!1,configurable:!0});throw e.invalidUsageError??=t,t}function c(){let e=a.afterTaskAsyncStorage.getStore();return(null==e?void 0:e.rootTaskSpawnPhase)==="action"}},36248:(e,t,i)=>{"use strict";i.d(t,{x:()=>o});var s=i(36463),a=i(86220);class n{static getInstance(){return n.instance||(n.instance=new n),n.instance}async initialize(){try{s.vF.info("Initializing Step-by-Step Automation System..."),await this.loadDefaultWorkflows(),this.startExecutionEngine(),this.startScheduler(),s.vF.info("Step-by-Step Automation System initialized successfully")}catch(e){throw s.vF.error("Failed to initialize Step-by-Step Automation System",e),e}}async registerWorkflow(e){let t=`workflow_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,i={...e,id:t,createdAt:new Date,updatedAt:new Date};return this.workflows.set(t,i),await this.saveWorkflow(i),s.vF.info(`Workflow registered: ${i.name} (${t})`),t}async executeWorkflow(e,t){let i=this.workflows.get(e);if(!i)throw Error(`Workflow not found: ${e}`);if(!i.enabled)throw Error(`Workflow is disabled: ${e}`);let a=`exec_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,n={id:a,workflowId:e,status:"pending",startTime:new Date,currentStep:"",completedSteps:[],failedSteps:[],progress:0,logs:[],metadata:t||{}};return this.executions.set(a,n),this.executionQueue.push(a),s.vF.info(`Workflow execution queued: ${i.name} (${a})`),a}async getExecutionStatus(e){return this.executions.get(e)||null}async cancelExecution(e){let t=this.executions.get(e);if(!t)throw Error(`Execution not found: ${e}`);"running"===t.status&&(t.status="cancelled",t.endTime=new Date,await this.addExecutionLog(e,"info","Execution cancelled by user"));let i=this.executionQueue.indexOf(e);i>-1&&this.executionQueue.splice(i,1),s.vF.info(`Execution cancelled: ${e}`)}getWorkflows(){return Array.from(this.workflows.values())}async getExecutionHistory(e,t=50){let i=Array.from(this.executions.values()),s=i;return e&&(s=i.filter(t=>t.workflowId===e)),s.sort((e,t)=>t.startTime.getTime()-e.startTime.getTime()).slice(0,t)}async getSystemStatus(){let e=this.workflows.size,t=Array.from(this.workflows.values()).filter(e=>e.enabled).length,i=Array.from(this.executions.values()).filter(e=>"running"===e.status).length,s=this.executionQueue.length,a=await this.getExecutionHistory(void 0,100),n=a.length>0?a.filter(e=>"completed"===e.status).length/a.length*100:0;return{status:"running",timestamp:new Date,workflows:{total:e,active:t,inactive:e-t},executions:{running:i,queued:s,maxConcurrent:this.maxConcurrentExecutions,currentUtilization:i/this.maxConcurrentExecutions*100},performance:{successRate:Math.round(100*n)/100,averageExecutionTime:await this.calculateAverageExecutionTime(),totalExecutions:a.length}}}async loadDefaultWorkflows(){let e={id:"health_check_workflow",name:"系统健康检查",description:"定期检查系统各个组件的健康状态",version:"1.0.0",steps:[{id:"check_database",name:"检查数据库连接",description:"验证数据库连接和性能",category:"monitoring",priority:"high",estimatedDuration:30,dependencies:[],conditions:[{type:"time_based",operator:"equals",value:"every_5_minutes"}],actions:[{type:"api_call",config:{endpoint:"/api/health/database",method:"GET"}}],retryPolicy:{maxAttempts:3,backoffStrategy:"exponential",initialDelay:1e3,maxDelay:1e4},status:"pending",progress:0},{id:"check_apis",name:"检查API服务",description:"验证所有API端点的可用性",category:"monitoring",priority:"high",estimatedDuration:60,dependencies:["check_database"],conditions:[],actions:[{type:"api_call",config:{endpoint:"/api/health/all",method:"GET"}}],retryPolicy:{maxAttempts:2,backoffStrategy:"linear",initialDelay:2e3,maxDelay:5e3},status:"pending",progress:0},{id:"check_disk_space",name:"检查磁盘空间",description:"确保有足够的磁盘空间",category:"monitoring",priority:"medium",estimatedDuration:15,dependencies:[],conditions:[],actions:[{type:"script_execution",config:{command:"df -h",threshold:80}}],status:"pending",progress:0}],triggers:[{type:"scheduled",config:{cron:"*/5 * * * *"}}],schedule:"*/5 * * * *",enabled:!0,createdAt:new Date,updatedAt:new Date,status:"active"},t={id:"performance_optimization_workflow",name:"系统性能优化",description:"自动优化系统性能和资源使用",version:"1.0.0",steps:[{id:"analyze_performance",name:"分析性能指标",description:"收集和分析系统性能数据",category:"optimization",priority:"medium",estimatedDuration:120,dependencies:[],conditions:[{type:"metric_threshold",operator:"greater_than",metric:"cpu_usage",threshold:70,value:null}],actions:[{type:"api_call",config:{endpoint:"/api/monitoring/performance-metrics",method:"GET"}}],status:"pending",progress:0},{id:"optimize_cache",name:"优化缓存",description:"清理和优化缓存策略",category:"optimization",priority:"medium",estimatedDuration:60,dependencies:["analyze_performance"],conditions:[],actions:[{type:"api_call",config:{endpoint:"/api/monitoring/optimize",method:"POST"}}],status:"pending",progress:0},{id:"restart_services",name:"重启服务",description:"重启需要优化的服务",category:"optimization",priority:"high",estimatedDuration:180,dependencies:["optimize_cache"],conditions:[],actions:[{type:"script_execution",config:{command:"systemctl restart nginx"}}],rollbackActions:[{type:"script_execution",config:{command:"systemctl start nginx"}}],retryPolicy:{maxAttempts:1,backoffStrategy:"fixed",initialDelay:5e3,maxDelay:5e3},status:"pending",progress:0}],triggers:[{type:"event_based",config:{event:"high_cpu_usage"}}],enabled:!0,createdAt:new Date,updatedAt:new Date,status:"active"};this.workflows.set(e.id,e),this.workflows.set(t.id,t),s.vF.info(`Loaded ${this.workflows.size} default workflows`)}startExecutionEngine(){setInterval(async()=>{if(this.currentExecutions<this.maxConcurrentExecutions&&this.executionQueue.length>0){let e=this.executionQueue.shift();e&&(this.currentExecutions++,this.executeWorkflowSteps(e).finally(()=>{this.currentExecutions--}))}},1e3)}startScheduler(){setInterval(async()=>{let e=new Date;for(let t of this.workflows.values())t.enabled&&t.schedule&&this.shouldScheduleWorkflow(t,e)&&(await this.executeWorkflow(t.id),t.lastRun=e)},6e4)}async executeWorkflowSteps(e){let t=this.executions.get(e);if(!t)return;let i=this.workflows.get(t.workflowId);if(i)try{for(let s of(t.status="running",await this.addExecutionLog(e,"info",`Starting workflow: ${i.name}`),i.steps)){if("cancelled"===t.status)break;if(!await this.checkStepDependencies(s,t)||!await this.checkStepConditions(s)){s.status="skipped";continue}await this.executeStep(s,t)}"cancelled"!==t.status&&(t.status="completed",t.endTime=new Date,t.progress=100,await this.addExecutionLog(e,"info","Workflow completed successfully"))}catch(i){t.status="failed",t.endTime=new Date,await this.addExecutionLog(e,"error",`Workflow failed: ${i.message}`),s.vF.error(`Workflow execution failed: ${e}`,i)}}async executeStep(e,t){e.status="running",e.startTime=new Date,t.currentStep=e.id,await this.addExecutionLog(executionId,"info",`Executing step: ${e.name}`);try{for(let i of e.actions)await this.executeAction(i,e,t);e.status="completed",e.endTime=new Date,e.progress=100,t.completedSteps.push(e.id);let i=this.workflows.get(t.workflowId);i&&(t.progress=t.completedSteps.length/i.steps.length*100),await this.addExecutionLog(executionId,"info",`Step completed: ${e.name}`)}catch(i){if(e.status="failed",e.endTime=new Date,e.errorMessage=i.message,t.failedSteps.push(e.id),await this.addExecutionLog(executionId,"error",`Step failed: ${e.name} - ${i.message}`),e.retryPolicy&&await this.shouldRetryStep(e))await this.retryStep(e,t);else throw i}}async executeAction(e,t,i){switch(e.type){case"api_call":await this.executeApiCall(e);break;case"script_execution":await this.executeScript(e);break;case"database_operation":await this.executeDatabaseOperation(e);break;case"notification":await this.sendNotification(e);break;case"custom":await this.executeCustomAction(e);break;default:throw Error(`Unknown action type: ${e.type}`)}}async executeApiCall(e){s.vF.debug(`Executing API call: ${e.config.endpoint}`)}async executeScript(e){s.vF.debug(`Executing script: ${e.config.command}`)}async executeDatabaseOperation(e){s.vF.debug(`Executing database operation: ${e.config.operation}`)}async sendNotification(e){s.vF.debug(`Sending notification: ${e.config.message}`)}async executeCustomAction(e){s.vF.debug(`Executing custom action: ${e.config.handler}`)}async checkStepDependencies(e,t){return e.dependencies.every(e=>t.completedSteps.includes(e))}async checkStepConditions(e){for(let t of e.conditions)if(!await this.evaluateCondition(t))return!1;return!0}async evaluateCondition(e){switch(e.type){case"system_health":case"time_based":case"metric_threshold":default:return!0;case"custom":return!e.customCheck||await e.customCheck()}}async shouldRetryStep(e){return!1}async retryStep(e,t){}shouldScheduleWorkflow(e,t){return!e.lastRun||t.getTime()-e.lastRun.getTime()>3e5}async addExecutionLog(e,t,i,s){let a=this.executions.get(e);if(!a)return;let n={timestamp:new Date,level:t,message:i,details:s};a.logs.push(n),a.logs.length>1e3&&(a.logs=a.logs.slice(-500))}async saveWorkflow(e){await a.Y.setex(`workflow:${e.id}`,604800,JSON.stringify(e))}async calculateAverageExecutionTime(){let e=(await this.getExecutionHistory(void 0,50)).filter(e=>"completed"===e.status&&e.endTime);return 0===e.length?0:e.reduce((e,t)=>e+(t.endTime.getTime()-t.startTime.getTime()),0)/e.length/1e3}constructor(){this.workflows=new Map,this.executions=new Map,this.isRunning=!1,this.executionQueue=[],this.maxConcurrentExecutions=3,this.currentExecutions=0}}let o=n.getInstance()},36463:(e,t,i)=>{"use strict";i.d(t,{vF:()=>a});class s{static getInstance(){return s.instance||(s.instance=new s),s.instance}setLogLevel(e){this.logLevel=e}shouldLog(e){return e<=this.logLevel}formatMessage(e,t,i){let s=new Date().toISOString(),a=i?` | Data: ${JSON.stringify(i)}`:"";return`[${s}] [${e}] ${t}${a}`}error(e,t){this.shouldLog(0)&&console.error(this.formatMessage("ERROR",e,t))}warn(e,t){this.shouldLog(1)&&console.warn(this.formatMessage("WARN",e,t))}info(e,t){this.shouldLog(2)&&console.info(this.formatMessage("INFO",e,t))}debug(e,t){this.shouldLog(3)&&console.debug(this.formatMessage("DEBUG",e,t))}constructor(){this.logLevel=2}}let a=s.getInstance()},43763:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ReflectAdapter",{enumerable:!0,get:function(){return i}});class i{static get(e,t,i){let s=Reflect.get(e,t,i);return"function"==typeof s?s.bind(e):s}static set(e,t,i,s){return Reflect.set(e,t,i,s)}static has(e,t){return Reflect.has(e,t)}static deleteProperty(e,t){return Reflect.deleteProperty(e,t)}}},78335:()=>{},86220:(e,t,i)=>{"use strict";i.d(t,{Y:()=>a});class s{isExpired(e){let t=this.cache.get(e);return!t||!!t.expiry&&Date.now()>t.expiry}cleanupExpired(){for(let[e]of this.cache)this.isExpired(e)&&this.cache.delete(e)}async get(e){this.cleanupExpired();let t=this.cache.get(e);return t?t.value:null}async set(e,t,i){let s=i?Date.now()+1e3*i:void 0;this.cache.set(e,{value:t,expiry:s})}async setex(e,t,i){let s=Date.now()+1e3*t;this.cache.set(e,{value:i,expiry:s})}async del(e){this.cache.delete(e),this.hashCache.delete(e)}async exists(e){return this.cleanupExpired(),this.cache.has(e)||this.hashCache.has(e)}async expire(e,t){let i=this.cache.get(e);i&&(i.expiry=Date.now()+1e3*t)}async hget(e,t){let i=this.hashCache.get(e);return i&&i.get(t)||null}async hset(e,t,i){this.hashCache.has(e)||this.hashCache.set(e,new Map),this.hashCache.get(e).set(t,i)}async hdel(e,t){let i=this.hashCache.get(e);i&&(i.delete(t),0===i.size&&this.hashCache.delete(e))}async incr(e){let t=await this.get(e),i=t?parseInt(t,10)+1:1;return await this.set(e,i.toString()),i}async decr(e){let t=await this.get(e),i=t?parseInt(t,10)-1:-1;return await this.set(e,i.toString()),i}async lpush(e,t){this.listCache.has(e)||this.listCache.set(e,[]);let i=this.listCache.get(e);return i.unshift(t),i.length}async rpush(e,t){this.listCache.has(e)||this.listCache.set(e,[]);let i=this.listCache.get(e);return i.push(t),i.length}async lrange(e,t,i){let s=this.listCache.get(e)||[],a=-1===i?s.length:i+1;return s.slice(t,a)}async keys(e){let t=RegExp("^"+e.replace(/\*/g,".*")+"$"),i=[];for(let e of this.cache.keys())t.test(e)&&i.push(e);return i}constructor(){this.cache=new Map,this.hashCache=new Map,this.listCache=new Map}}let a=new s},96487:()=>{}};